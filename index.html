<section>
  <h2>ðŸ“¦ SQL Projects & Query Documentation</h2>
  <p>This section contains real SQL scripts written for the GRProject Power BI dashboard. It supports understanding how each visual was powered by structured SQL queries.</p>

  <details>
    <summary><strong>â–¶ Demographics</strong></summary>
    <pre><code>
SELECT
    p.PersonID,
    p.CaseId,
    p.FirstName,
    p.LastName,
    p.DateOfBirth,
    p.ArrivalDate,
    YEAR(p.ArrivalDate) AS ArrivalYear,
    DATEDIFF(YEAR, p.DateOfBirth, GETDATE()) AS Age,
    CASE 
        WHEN DATEDIFF(YEAR, p.DateOfBirth, GETDATE()) < 18 THEN 'Under 18'
        WHEN DATEDIFF(YEAR, p.DateOfBirth, GETDATE()) BETWEEN 18 AND 35 THEN '18â€“35'
        WHEN DATEDIFF(YEAR, p.DateOfBirth, GETDATE()) BETWEEN 36 AND 60 THEN '36â€“60'
        ELSE '60+'
    END AS AgeGroup,
    c.CountryName,
    r.Homeregion AS HomeRegion,
    g.Gender,
    e.LevelName AS EducationLevel
FROM 
    [dbo].[Personal information_main] p
JOIN [dbo].[Country] c ON p.CountryID = c.CountryID
JOIN [dbo].[Region] r ON p.HomeRegion = r.ID
JOIN [dbo].[gender] g ON p.GenderID = g.GenderID
JOIN [dbo].[EducationLevel] e ON p.EducationLevelID = e.EducationLevelID;
    </code></pre>
  </details>

  <details>
    <summary><strong>â–¶ Vulnerability</strong></summary>
    <pre><code>
SELECT 
    pim.PersonID,
    pim.CaseId,
    c.CountryName,
    r.Homeregion AS HomeRegion,
    g.Gender,
    pv.VulnerabilityName AS PrimaryVulnerability,
    sv.VulnerabilityName AS SecondaryVulnerability,
    CASE 
        WHEN pv.VulnerabilityName IS NOT NULL AND sv.VulnerabilityName IS NOT NULL 
        THEN 'Yes' 
        ELSE 'No' 
    END AS TwoVul_Types,
    CASE 
        WHEN DATEDIFF(YEAR, pim.DateOfBirth, GETDATE()) < 18 THEN 'Under 18'
        WHEN DATEDIFF(YEAR, pim.DateOfBirth, GETDATE()) BETWEEN 18 AND 35 THEN '18â€“35'
        WHEN DATEDIFF(YEAR, pim.DateOfBirth, GETDATE()) BETWEEN 36 AND 60 THEN '36â€“60'
        ELSE '60+'
    END AS AgeGroup,
    YEAR(pim.ArrivalDate) AS ArrivalYear
FROM dbo.[Personal information_main] pim
LEFT JOIN dbo.Country c ON pim.CountryID = c.CountryID
LEFT JOIN dbo.Region r ON pim.HomeRegion = r.ID
LEFT JOIN dbo.gender g ON pim.GenderID = g.GenderID
LEFT JOIN dbo.Vulnerability pv ON pim.PrimaryVulnerabilityID = pv.VulnerabilityID
LEFT JOIN dbo.Vulnerability sv ON pim.SecondaryVulnerabilityID = sv.VulnerabilityID
WHERE pim.PrimaryVulnerabilityID IS NOT NULL OR pim.SecondaryVulnerabilityID IS NOT NULL;
    </code></pre>
  </details>

  <details>
    <summary><strong>â–¶ Reintegration</strong></summary>
    <pre><code>
[Paste full Reintegration SQL here due to length â€“ suggest using code blocks or CDN for large code]
    </code></pre>
  </details>

  <details>
    <summary><strong>â–¶ Mhpss</strong></summary>
    <pre><code>
[Paste full Mhpss SQL here due to length â€“ same approach]
    </code></pre>
  </details>

  <details>
    <summary><strong>â–¶ Medical</strong></summary>
    <pre><code>
[Paste full Medical SQL here due to length â€“ consider external file if large]
    </code></pre>
  </details>

  <details>
    <summary><strong>â–¶ Monitoring and Evaluation</strong></summary>
    <pre><code>
[Paste full Monitoring and Evaluation SQL here due to length â€“ best kept modular]
    </code></pre>
  </details>
</section>
